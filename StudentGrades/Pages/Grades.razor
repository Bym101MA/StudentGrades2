@page "/grades"
@using StudentGrades.Data
@using StudentGrades.Models
@inject AppDbContext Db

<h3>Выставить оценку</h3>

<EditForm Model="grade" OnValidSubmit="AddGrade">
    <select @bind="grade.StudentId" class="form-control my-1">
        <option value="0">Выберите студента</option>
        @foreach (var s in Db.Students)
        {
            <option value="@s.Id">@s.FullName</option>
        }
    </select>
    <select @bind="grade.SubjectId" class="form-control my-1">
        <option value="0">Выберите предмет</option>
        @foreach (var s in Db.Subjects)
        {
            <option value="@s.Id">@s.Name</option>
        }
    </select>
    <select @bind="grade.TeacherId" class="form-control my-1">
        <option value="0">Выберите преподавателя</option>
        @foreach (var t in Db.Teachers)
        {
            <option value="@t.Id">@t.FullName</option>
        }
    </select>
    <InputNumber @bind-Value="grade.Score" class="form-control my-1" />
    <button type="submit" class="btn btn-primary mt-1">Добавить оценку</button>
</EditForm>

<table class="table mt-3">
    <thead><tr><th>Студент</th><th>Предмет</th><th>Преподаватель</th><th>Оценка</th></tr></thead>
    <tbody>
        @foreach (var g in Db.Grades)
        {
            <tr>
                <td>@g.Student.FullName</td>
                <td>@g.Subject.Name</td>
                <td>@g.Teacher.FullName</td>
                <td>@g.Score</td>
            </tr>
        }
    </tbody>
</table>

@code {
    private Grade grade = new Grade();

    private void AddGrade()
    {
        Db.Grades.Add(grade);
        Db.SaveChanges();
        grade = new Grade();
    }
}
